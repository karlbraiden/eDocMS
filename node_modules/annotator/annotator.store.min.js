/*
** Annotator v2.0.0-dev-d00e70f
** https://github.com/okfn/annotator/
**
** Copyright 2014, the Annotator project contributors.
** Dual licensed under the MIT and GPLv3 licenses.
** https://github.com/okfn/annotator/blob/master/LICENSE
**
** Built at: 2014-04-11 18:30:25Z
*/
!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self);var o=e;o=o.Annotator||(o.Annotator={}),o=o.Plugin||(o.Plugin={}),o.Store=t()}}(function(){return function t(e,o,n){function r(a,s){if(!o[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var d=o[a]={exports:{}};e[a][0].call(d.exports,function(t){var o=e[a][1][t];return r(o?o:t)},d,d.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({"4hR4NO":[function(t,e){(function(t){var o,n,r;if("undefined"!=typeof n&&null!==n&&(n=n),"undefined"!=typeof t&&null!==t&&null==n&&(n=t),"undefined"!=typeof window&&null!==window&&null==n&&(n=window),o=null!=n?n.Annotator:void 0,null==o&&(o=(null!=n?null!=(r=n.define)?r.amd:void 0:void 0)?null!=n?n.require("annotator"):void 0:void 0),"function"!=typeof o)throw new Error("Could not find Annotator! In a webpage context, please ensure that the Annotator script tag is loaded before any plugins.");e.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],annotator:[function(t,e){e.exports=t("4hR4NO")},{}],3:[function(t,e){var o,n,r,i,a;n=t("annotator"),i=n.Util,o=i.$,a=i.TranslationString,r=function(){function t(t){this.options=o.extend(!0,{},this.options,t)}return t.prototype.options={annotationData:null,emulateHTTP:!1,emulateJSON:!1,headers:{},prefix:"/store",urls:{create:"/annotations",read:"/annotations/:id",update:"/annotations/:id",destroy:"/annotations/:id",search:"/search"}},t.prototype.create=function(t){return this._apiRequest("create",t)},t.prototype.update=function(t){return this._apiRequest("update",t)},t.prototype["delete"]=function(t){return this._apiRequest("destroy",t)},t.prototype.query=function(t){var e;return e=o.Deferred(),this._apiRequest("search",t).done(function(t){var o;return o=t.rows,delete t.rows,e.resolve(o,t)}).fail(function(){return e.reject.apply(e,arguments)}),e.promise()},t.prototype.setHeader=function(t,e){return this.options.headers[t]=e},t.prototype._apiRequest=function(t,e){var n,r,i,a;return n=e&&e.id,a=this._urlFor(t,n),r=this._apiRequestOptions(t,e),i=o.ajax(a,r),i._id=n,i._action=t,i},t.prototype._apiRequestOptions=function(t,e){var n,r,a;return r=this._methodFor(t),a={type:r,dataType:"json",error:this._onError,headers:this.options.headers},!this.options.emulateHTTP||"PUT"!==r&&"DELETE"!==r||(a.headers=o.extend(a.headers,{"X-HTTP-Method-Override":r}),a.type="POST"),"search"===t?a=o.extend(a,{data:e}):(null!=this.options.annotationData&&(i.deprecationWarning("Use of the annotationData option to the Store plugin is deprecated and will be removed in a future version. Please use hooks to beforeAnnotationCreated and beforeAnnotationUpdated to replicate this behaviour."),o.extend(e,this.options.annotationData)),n=e&&JSON.stringify(e),this.options.emulateJSON?(a.data={json:n},this.options.emulateHTTP&&(a.data._method=r),a):a=o.extend(a,{data:n,contentType:"application/json; charset=utf-8"}))},t.prototype._urlFor=function(t,e){var o;return o=null!=this.options.prefix?this.options.prefix:"",o+=this.options.urls[t],o=o.replace(/\/:id/,null!=e?"/"+e:""),o=o.replace(/:id/,null!=e?e:"")},t.prototype._methodFor=function(t){var e;return e={create:"POST",read:"GET",update:"PUT",destroy:"DELETE",search:"GET"},e[t]},t.prototype._onError=function(t){var e,o;switch(e=t._action,o=a("Sorry we could not ")+e+a(" this annotation"),"search"===t._action?o=a("Sorry we could not search the store for annotations"):"read"!==t._action||t._id||(o=a("Sorry we could not ")+e+a(" the annotations from the store")),t.status){case 401:o=a("Sorry you are not allowed to ")+e+a(" this annotation");break;case 404:o=a("Sorry we could not connect to the annotations store");break;case 500:o=a("Sorry something went wrong with the annotation store")}return n.showNotification(o,n.Notification.ERROR),console.error(a("API request failed:")+(" '"+t.status+"'"))},t}(),n.Plugin.register("Store",r),e.exports=r},{}]},{},[3])(3)});
//# sourceMappingURL=annotator.store.min.js.map